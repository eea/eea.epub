<?xml version="1.0"?>
<contentrules>
 <rule name="eea-epub-rule-fail" title="ePub export failed" cascading="False"
    description="Notify the person who requested a ePub export that the ePub export failed."
    enabled="True" event="eea.epub.events.interfaces.IAsyncEPUBExportFail"
    stop-after="False">
  <conditions/>
  <actions>
   <action type="plone.actions.Mail">
    <property name="source"/>
    <property
       name="message">Our apologies, your request to export ePub for ${download_came_from_url} failed.

Please try again later at ${download_came_from_url}

----------
This email is auto-generated and delivered to you because a ePub export was requested for ${download_came_from_url}. If you did not request this ePub then just ignore this email.
----------</property>
    <property name="subject">[${download_title}] Your ePub is NOT ready</property>
    <property name="recipients">${download_email}</property>
    <property name="exclude_actor">False</property>
   </action>
  </actions>
 </rule>
 <rule name="eea-epub-rule-success" title="ePub export succeeded" cascading="False"
    description="Notify the person who requested a ePub export that the ePub successfully exported and provide a link to the downloadable ePub"
    enabled="True" event="eea.epub.events.interfaces.IAsyncEPUBExportSuccess"
    stop-after="False">
  <conditions/>
  <actions>
   <action type="plone.actions.Mail">
    <property name="source"/>
    <property
       name="message">Your ePub is ready and it is available for you to download at any time for at least 1 day using the following address ${download_url}.

If the link expired you can always request another ePub at ${download_came_from_url}

----------
This email is auto-generated and delivered to you because a ePub export was requested for ${download_came_from_url}. If you did not request this ePub then just ignore this email.
----------</property>
    <property name="subject">[${download_title}] Your ePub is ready</property>
    <property name="recipients">${download_email}</property>
    <property name="exclude_actor">False</property>
   </action>
  </actions>
 </rule>
 <rule name="eea-epub-rule-admin" title="ePub export failed (admin)" cascading="False"
    description="Notify admin that there were issues while exporting ePub"
    enabled="True" event="eea.epub.events.interfaces.IAsyncEPUBExportFail"
    stop-after="False">
  <conditions/>
  <actions>
   <action type="plone.actions.Mail">
    <property name="source"/>
    <property
       name="message">There was an issue while exporting ePub at ${download_came_from_url}.
Please fix the issue as soon as possible and notify the user with email ${download_email} that he/she can request a new ePub.

Error:
${download_error}

----------
This email is auto-generated and delivered to you because a ePub export was requested for ${download_came_from_url}.
----------</property>
    <property name="subject">[${download_title}] ePub export failed</property>
    <property name="recipients">${download_from_email}</property>
    <property name="exclude_actor">False</property>
   </action>
  </actions>
 </rule>
 <assignment name="eea-epub-rule-fail" bubbles="True" enabled="True" location=""/>
 <assignment name="eea-epub-rule-success" bubbles="True" enabled="True" location=""/>
 <assignment name="eea-epub-rule-admin" bubbles="True" enabled="True" location=""/>
</contentrules>
